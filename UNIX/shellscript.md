# シェルスクリプト

OSを操作する為のシェル上で実行できる簡易なプログラミング言語(スクリプト言語)

複数のコマンドや処理を1つのファイルにまとめることで、シェルスクリプトを実行すると記述された内容を自動的に実行してくれる。

定期作業の自動化ができたり、複数のコマンドをまとめて処理することができる。

---

- 基本

`①使用するシェルの宣言(シバン 【shebang】 シェバン)`

スクリプトファイルの1行目にスクリプトを実行するシェルを指定する。

`#!`に続けて実行ファイルのパスを指定する。

bashの場合
```bash
#!/bin/bash
```
zshの場合
```bash
#!/bin/zsh
```
#!/usr/bin/bashや#!/usr/bin/zshのように記載することもある。

これはbashやzshが/binにあるのか、/usr/binにあるのか実行環境によって異なる為。

自分のPCの場合はどちらも/bin以下にあった。

---

存在しないパスをシバンに記述するとどうなるか？

`zsh: ./john.zsh: bad interpreter: /usr/bin/zsh: no such file or directory`

のようなエラーが出て実行できない。実行環境によって適切なパスを指定することが大切。

→`./john.zsh` で実行するとエラーでましたが、`zsh john.zsh`コマンドで実行するといけた。

---

`②とりあえず作ってみる`

シェルスクリプトの拡張子は.shや.zshにする。

bash→.sh, zsh→.zsh(.shでzshを使用しても一応動く)

今回はjohn.zshというファイル名で作成してみる。
```bash
#!/bin/zsh
 
name=じょん
 
echo こんにちは$nameさん。
```

---

`③シェルスクリプトの実行(パーミッション)`

作成したファイルがあるディレクトにて

`./john.zsh` もしくは`zsh john.zsh` コマンドにて実行する。(bashの場合はbash ファイル名)

./john.zshにて実行した時にこんなエラーが出た。(zshコマンドでは実行できた)
```
zsh: permission denied: ./john.zsh
```
これは実行権限が与えられていないため。

chmodコマンドでファイルの権限を変更する。

その前にファイルの権限を確認してみる。

`ls -l john.zsh (ファイル名)`
```
-rw-r--r--  1 kery  staff   63  6 14 10:48 john.zsh
```
左側の-やrやwが書いてあるとこに注目。

一番左の`-`はファイルかディレクトなのかを表す。

その右側9つの文字はそれぞれ3つごとに「所有者」「グループ」「その他ユーザー」

つまり最初の3つ`rw-`は所有者の権限は読み込みと書き込みだけです〜みたいな意味。

次のグループとその他ユーザーの`r--`は読み込みのみの意味。

`r`：は読み出しの許可

`w`：は書き込みの許可

`x`：は実行の許可

`-`：は対象の権限が与えられいない

chmodコマンドは `chmod 権限の数値(3桁) ファイル名` の形でファイル名の権限を変更する。

パーミッション対応表

| アクセス権 | 数値 | 説明 |
| --- | --- | --- |
| --- | 0 | 全部できない(読み書き込み実行不可) |
| --x | 1 | 実行のみ |
| -w- | 2 | 書き込みのみ |
| -rw | 3 | 書き込み実行のみ |
| r-- | 4 | 読み込みのみ |
| r-x | 5 | 読み込み実行のみ |
| rw- | 6 | 読み込み書き込みのみ |
| rwx | 7 | 全部できる(読み込み書き込み実行) |

今回は所有者の権限に実行を加えたいので
```
chmod 744 john.zsh
```
と実行するとls -l john.zshの結果が
```
-rwxr--r-- (略)
```
と変わった!! (-rw-r--r-- → -rwxr--r--)

これで`./john.zsh`コマンドでもシェルスクリプトが実行できるようになる!!
