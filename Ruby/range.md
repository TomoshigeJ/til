# 範囲

- 範囲リテラル

範囲リテラルは範囲そのものを表す値を生成し、ループや条件分岐はもちろん、配列の要素の指定などさまざまな箇所で使用できる。

範囲の値は式の間に`..`を記述することで生成できる。

`..`は範囲に右の式の結果を含み、`…` は右の式の結果を含まない。

→`..` は「以下」、`…`は「未満」で覚える！

```ruby
(1..10).each do |i|
  p i
end
# => 1~10まで出力

str = ''
for s in ('a'..'z')
  str.concat s
end
p str
# => "abcdefghijklmnopqrstuvwxyz"
```

`1..10` や `‘a’..’z’` のように生成した値は範囲オブジェクトと呼ばれ、Rangeクラスのインスタンスとなる。

`include?`メソッドを利用して、引数で指定した値が範囲に含まれているかどうかを判定可能。

→`===`演算子でも同じ結果になる

範囲オブジェクトでは`==は同値判定`、`===は包含判定`になる点に注意！

```ruby
p (1..5).include?(5)  # => true
p (1...5).include?(5) # => false
p (1..5) == 2         # => false
p (1..5) === 2        # => true
p (1..5) === 8        # => false
```

配列の添字演算子に範囲オブジェクトを適用

```ruby
a = [0, 1, 2, 3, 4, 5, 6, 7]
p a[2, 3]  # => [2, 3, 4]
p a[2..3]  # => [2, 3]
p a[2...3] # => [2]
```

文字列の添字演算子に範囲オブジェクトを適用

```ruby
s = 'abcdefghijk'
p s[2]     # => "c"
p s[2..3]  # => "cd"
p s[2...3] # => "c"
```

---

- case式

他のプログラミング言語ではswitch文に相当するやつ。

```ruby
case <式>
when <条件式1> [then]
  処理1...
when <条件式2> [then]
  処理2...
else
  処理3...
end
```

```ruby
case 1
when 1 then
  p 1
end
# => 1

case 'abc'
when 'abc' then
  p 'A'
when 'abc' then
  p 'B' # こっちは実行されない
end
# => "A"

a = 10
b = case a
when 1 then
  1
else
  2
end
p b # => 2
```

カンマで区切って複数の条件を指定することもできる。

これはor条件となり、どれか1つにマッチすると実行される。

マッチの判定は`===`演算子にて行われる。

```ruby
case 3
when 1, 2 then; p 1
when 3, 4 then; p 2
else p 3
end
# => 2
```

条件式に範囲を指定

```ruby
case 7
when 1...5 then; p 1
when 5..10 then; p 2
end
# => 2
```

`(1…5) === 7` と`(5..10) === 7` を評価している。

範囲オブジェクト(Rangeクラス)では===は包含判定なので2が返る。

---

- while式とuntil式

`while式`

条件を満たす間、処理を繰り返す。構文のdoは省略可能。

```ruby
i = 0
while (0..4) === i do
  p i
  i += 1
end
# => 0~4までが出力
```

`until式`

条件を満たすまでループを繰り返すuntil式も提供されている。

```ruby
i = 0
until i == 5 do
  p i
  i += 1
end
# => 0~4までが出力
```

→`i`が`5`に `==` になるまで処理を繰り返す。

while式、until式はこの他にもさまざまな書き方が提供されている。

`後置while`

最初のbegin節は条件に関わらず必ず実行される。

```ruby
i = 0
begin
  p i
  i += 1
end while(1..4) === i
# => 0~4までが出力
```

`while修飾子`

if式と同じように修飾子として記述も可能。

```ruby
i = 0
p i += 1 while (0..4) === i
# => # => 0~5までが出力
```

なぜこの場合は1~5までが出力されるのか？

①まずwhile中の条件式が評価される。

②次に`i`の値が表示される。→このときに`+= 1`しているから。
