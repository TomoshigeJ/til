# 文字列

- 文字列リテラル

シングルクォートもしくはダブルクォートで囲むことで文字列の値として解釈される。

Stringクラスのインスタンス。

```ruby
a = 'abcd'
p a # => 'abcd'
p a.class # => String
b = 'ab' "cd"
p b # => 'abcd'
```

---

- 式展開

式展開時は`ダブルクォート`で囲むこと。

→シングルクォートだと文字列として解釈される

```ruby
a = 1
p "a is #{a}" # => "a is 1"
p 'a is #{a}' # => "a is \#{a}"
```

`#{}`の内部では任意の式を指定することができ、評価結果の値の`to_sメソッド`が呼び出される。

ちなみにJavaScriptの式展開は`${}でバッククォート( `` )`で囲む。

---

- バックスラッシュ記法

バックスラッシュ( `\` )はMacの場合`optionキー + ¥`で入力。

シングルクォートやダブルクォートを文字列そのものとして扱いときなど、エスケープすることができる。

`\x` ：xの文字そのものを成形

`\n` ：改行

`\s` ：空白

などいろいろあり。

改行の`\n`を適用した結果を確認したいときはpメソッドでなく、`print`や`puts`メソッドを使用

する。

出力メソッドの違い

| メソッド | 改行 | 出力内容の構築メソッド | バックスラッシュ記法 |
| --- | --- | --- | --- |
| p | 引数ごとに改行 | inspectメソッド | そのまま出力 |
| print | 改行しない | to_sメソッド | 適用した結果を出力 |
| puts | 引数ごとに改行 | to_sメソッド | 適用した結果を出力 |

```ruby
irb(main):001:0> p "a\nb"
"a\nb"
=> "a\nb"
irb(main):002:0> print "a\nb"
a
b=> nil
irb(main):003:0> puts "a\nb"
a
b
=> nil
```

inspecメソッドはわかりやすい形式に構築してくれるメソッド。

文字列(Stringクラス)をダブルクォートで囲んだり、配列(Arrayクラス)を[]で囲んでくれたりする。

一般的にpメソッドはデバッグで用いるもの。

---

- ヒアドキュメント

バックスラッシュ記法を用いることで改行を含む文字列を指定できるが、可読性はよろしくない。

より簡単に改行コードを含む文字列を指定するために、Rubyではシェルスクリプトなどで採用されているヒアドキュメントを利用できる。

`<<`に続けて文字列の終端を示す任意の識別子を指定する。

```ruby
irb(main):016:0> dog = <<EOF
irb(main):017:0" John is a
irb(main):018:0" Super dog.
irb(main):019:0" EOF
=> "John is a\nSuper dog.\n"

irb(main):023:0> dog
=> "John is a\nSuper dog.\n"
```

ヒアドキュメントには、終端を示す識別子の前にはスペースなどの文字を記述してはいけないルールがある。

階層が深い場合のインデントにおいても行頭に指定しなければならない。

これを回避するためには開始の識別子の頭にハイフンをつけてあげる。

```ruby
# ヒアドキュメント

def dog
  <<-RESULT
    Ru
    by
  RESULT
end

p dog

# => "    Ru\n    by\n"
```

式展開やバックスラッシュ記法を無効にしたいときは開始の識別子をシングルクォートで囲み、式展開を有効にしたいときはダブルクォートで囲むのは同じ。

このとき、終端の識別子は囲まない点に注意。

---

- パーセント記法

文字列を囲む記号を自身で指定ができる。

```ruby
p %*test* # => "test"
```

エスケープなしでダブルクォートを文字列内に使用。

```ruby
p %*"test"* # => "\"test\""
```

文字列を囲む記号には、数値やアルファベット以外の文字が使用できる。

かっこ系： () [] {} <> などを使用する時は終端の記号は対応するもので。

パーセント記法を使用した文字列はダブルクォートで囲んだ時と同様に式展開が可能。

→ダブルクォートで囲んでいるとの同じ

→シングルクォートの場合は`%q`で指定してあげる。

他にも文字列以外の値なんかも用意されてる

| 書式 | 生成される値 |
| --- | --- |
| % | ダブルクォート文字列 |
| %Q | ダブルクォート文字列(%だけと同じ) |
| %q | シングルクォート文字列 |
| %s | シンボル |
| %i | シンボル(半角で区切られた単語は1つのシンボル) |
| %W | 要素がダブルクォートの配列 |
| %w | 要素がシングルクォートの配列 |
| %x | コマンド出力 |
| %r | 正規表現 |
